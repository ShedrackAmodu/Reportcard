{% extends 'base.html' %}
{% block title %}Install ReportCardApp - Multi-Tenant Report Card System{% endblock %}

{% block content %}
<div class="container py-5">
    <!-- Hero Section -->
    <div class="row align-items-center min-vh-100">
        <div class="col-lg-6">
            <div class="text-center text-lg-start">
                <h1 class="display-3 fw-bold text-primary mb-4">
                    ReportCardApp
                </h1>
                <h2 class="h3 text-dark mb-4">
                    Transform Your School Management Experience
                </h2>
                <p class="lead text-muted mb-5">
                    A powerful, offline-capable PWA for modern schools. Manage students, grades, 
                    attendance, and reports with ease - right from your home screen.
                </p>
                
                <!-- Key Features -->
                <div class="row g-3 mb-5">
                    <div class="col-md-6">
                        <div class="d-flex align-items-center">
                            <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                                <i class="bi bi-cloud-off text-white"></i>
                            </div>
                            <div>
                                <h6 class="mb-0">Offline Access</h6>
                                <small class="text-muted">Work without internet</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="d-flex align-items-center">
                            <div class="bg-success rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                                <i class="bi bi-lightning text-white"></i>
                            </div>
                            <div>
                                <h6 class="mb-0">Lightning Fast</h6>
                                <small class="text-muted">Instant loading</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="d-flex align-items-center">
                            <div class="bg-info rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                                <i class="bi bi-bell text-white"></i>
                            </div>
                            <div>
                                <h6 class="mb-0">Push Notifications</h6>
                                <small class="text-muted">Stay informed</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="d-flex align-items-center">
                            <div class="bg-warning rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                                <i class="bi bi-phone text-white"></i>
                            </div>
                            <div>
                                <h6 class="mb-0">Mobile Optimized</h6>
                                <small class="text-muted">Works everywhere</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Installation CTA -->
                <div class="d-flex flex-column flex-md-row gap-3">
                    <button class="btn btn-gradient btn-lg px-5 py-3" id="install-now-btn" onclick="pwaInstaller.installApp()">
                        <i class="bi bi-download me-2"></i>
                        Install App Now
                    </button>
                    <button class="btn btn-outline-primary btn-lg px-5 py-3" onclick="scrollToFeatures()">
                        <i class="bi bi-info-circle me-2"></i>
                        Learn More
                    </button>
                </div>

                <!-- Browser Support -->
                <div class="mt-4">
                    <small class="text-muted">
                        <i class="bi bi-browser me-2"></i>
                        Works on Chrome, Edge, Safari, and Firefox
                    </small>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="position-relative">
                <div class="bg-gradient rounded-4 p-4 shadow-lg">
                    <div class="bg-white rounded-3 p-3">
                        <div class="d-flex align-items-center mb-3">
                            <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                                <i class="bi bi-mortarboard-fill text-white"></i>
                            </div>
                            <div>
                                <h6 class="mb-0">ReportCardApp</h6>
                                <small class="text-muted">School Management</small>
                            </div>
                            <div class="ms-auto">
                                <span class="badge bg-success">PWA</span>
                            </div>
                        </div>
                        <div class="row g-2">
                            <div class="col-6">
                                <div class="card border-light">
                                    <div class="card-body p-2">
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-people text-primary me-2"></i>
                                            <div>
                                                <div class="small fw-bold">Students</div>
                                                <div class="x-small text-muted">Manage</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="card border-light">
                                    <div class="card-body p-2">
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-journal-text text-success me-2"></i>
                                            <div>
                                                <div class="small fw-bold">Grades</div>
                                                <div class="x-small text-muted">Track</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="card border-light">
                                    <div class="card-body p-2">
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-calendar-check text-warning me-2"></i>
                                            <div>
                                                <div class="small fw-bold">Attendance</div>
                                                <div class="x-small text-muted">Monitor</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="card border-light">
                                    <div class="card-body p-2">
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-file-earmark-text text-info me-2"></i>
                                            <div>
                                                <div class="small fw-bold">Reports</div>
                                                <div class="x-small text-muted">Generate</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Floating elements -->
                <div class="position-absolute top-0 start-0 translate-middle">
                    <div class="bg-success rounded-circle d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                        <i class="bi bi-check-lg text-white fs-3"></i>
                    </div>
                </div>
                <div class="position-absolute top-0 end-0 translate-middle">
                    <div class="bg-warning rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                        <i class="bi bi-star text-white"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Features Section -->
    <div class="row mt-5" id="features">
        <div class="col-12">
            <h2 class="text-center mb-5">Why Choose Our PWA?</h2>
        </div>
        
        <div class="col-lg-4 mb-4">
            <div class="card h-100 border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 64px; height: 64px;">
                        <i class="bi bi-lightning-fill text-white fs-2"></i>
                    </div>
                    <h5 class="card-title">Lightning Fast</h5>
                    <p class="card-text text-muted">
                        Experience app-like performance with instant loading times and smooth interactions.
                        No more waiting for pages to load.
                    </p>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4 mb-4">
            <div class="card h-100 border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="bg-success rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 64px; height: 64px;">
                        <i class="bi bi-cloud-off text-white fs-2"></i>
                    </div>
                    <h5 class="card-title">Offline Capable</h5>
                    <p class="card-text text-muted">
                        Work seamlessly without internet connection. Your data syncs automatically 
                        when you're back online.
                    </p>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4 mb-4">
            <div class="card h-100 border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="bg-info rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 64px; height: 64px;">
                        <i class="bi bi-bell-fill text-white fs-2"></i>
                    </div>
                    <h5 class="card-title">Real-time Updates</h5>
                    <p class="card-text text-muted">
                        Get instant notifications for important updates, deadlines, and new messages.
                        Never miss a beat.
                    </p>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4 mb-4">
            <div class="card h-100 border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="bg-warning rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 64px; height: 64px;">
                        <i class="bi bi-phone-fill text-white fs-2"></i>
                    </div>
                    <h5 class="card-title">Mobile Optimized</h5>
                    <p class="card-text text-muted">
                        Perfect experience on any device. Install on your phone, tablet, or desktop
                        for instant access.
                    </p>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4 mb-4">
            <div class="card h-100 border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="bg-danger rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 64px; height: 64px;">
                        <i class="bi bi-shield-check text-white fs-2"></i>
                    </div>
                    <h5 class="card-title">Secure & Private</h5>
                    <p class="card-text text-muted">
                        Your data is encrypted and secure. We respect your privacy and never 
                        share your information.
                    </p>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4 mb-4">
            <div class="card h-100 border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="bg-secondary rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 64px; height: 64px;">
                        <i class="bi bi-gear-fill text-white fs-2"></i>
                    </div>
                    <h5 class="card-title">Always Updated</h5>
                    <p class="card-text text-muted">
                        Automatic updates ensure you always have the latest features and security
                        improvements.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Installation Guide -->
    <div class="row mt-5">
        <div class="col-12">
            <h2 class="text-center mb-5">How to Install</h2>
        </div>
        
        <div class="col-lg-4 mb-4">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 80px; height: 80px;">
                        <i class="bi bi-browser text-white fs-1"></i>
                    </div>
                    <h5 class="card-title">1. Open in Browser</h5>
                    <p class="card-text text-muted">
                        Visit this page in your web browser on your phone or computer.
                    </p>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4 mb-4">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="bg-success rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 80px; height: 80px;">
                        <i class="bi bi-three-dots-vertical text-white fs-1"></i>
                    </div>
                    <h5 class="card-title">2. Tap Menu</h5>
                    <p class="card-text text-muted">
                        Look for the menu button (three dots) in your browser's address bar.
                    </p>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4 mb-4">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="bg-info rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 80px; height: 80px;">
                        <i class="bi bi-download text-white fs-1"></i>
                    </div>
                    <h5 class="card-title">3. Install App</h5>
                    <p class="card-text text-muted">
                        Select "Install App" or "Add to Home Screen" from the menu.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Testimonials -->
    <div class="row mt-5">
        <div class="col-12">
            <h2 class="text-center mb-5">What Users Say</h2>
        </div>
        
        <div class="col-lg-4 mb-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                            <i class="bi bi-person-fill text-white"></i>
                        </div>
                        <div>
                            <h6 class="mb-0">Sarah Johnson</h6>
                            <small class="text-muted">School Administrator</small>
                        </div>
                    </div>
                    <p class="card-text text-muted">
                        "This PWA has revolutionized how we manage our school. The offline capability 
                        is a game-changer for our rural campus."
                    </p>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4 mb-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="bg-success rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                            <i class="bi bi-person-fill text-white"></i>
                        </div>
                        <div>
                            <h6 class="mb-0">Michael Chen</h6>
                            <small class="text-muted">Teacher</small>
                        </div>
                    </div>
                    <p class="card-text text-muted">
                        "I love how fast and responsive it is. Being able to access student data 
                        offline during field trips is incredibly useful."
                    </p>
                </div>
            </div>
        </div>
        
        <div class="col-lg-4 mb-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="bg-info rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 40px; height: 40px;">
                            <i class="bi bi-person-fill text-white"></i>
                        </div>
                        <div>
                            <h6 class="mb-0">Lisa Rodriguez</h6>
                            <small class="text-muted">Parent</small>
                        </div>
                    </div>
                    <p class="card-text text-muted">
                        "The app makes it so easy to stay updated on my child's progress. 
                        The notifications keep me informed without being overwhelming."
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Final CTA -->
    <div class="row mt-5">
        <div class="col-12 text-center">
            <h2 class="mb-4">Ready to Get Started?</h2>
            <p class="lead text-muted mb-5">
                Join thousands of schools already benefiting from our PWA solution.
            </p>
            <button class="btn btn-gradient btn-lg px-5 py-3" onclick="pwaInstaller.installApp()">
                <i class="bi bi-download me-2"></i>
                Install ReportCardApp Now
            </button>
        </div>
    </div>
</div>

<!-- Installation Modal -->
<div class="modal fade" id="installation-modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg">
            <div class="modal-header bg-gradient text-white border-0">
                <h5 class="modal-title">Installation Complete!</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body text-center">
                <div class="bg-success rounded-circle d-flex align-items-center justify-content-center mx-auto mb-3" style="width: 64px; height: 64px;">
                    <i class="bi bi-check-lg text-white fs-1"></i>
                </div>
                <h6 class="text-success">Your app is now installed!</h6>
                <p class="text-muted">You can now access ReportCardApp from your home screen.</p>
            </div>
            <div class="modal-footer border-0">
                <button class="btn btn-success w-100" data-bs-dismiss="modal">
                    <i class="bi bi-check-circle me-2"></i>Got it!
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Enhanced landing page PWA installation
    document.addEventListener('DOMContentLoaded', function() {
        // Check if PWA is already installed
        if (window.matchMedia && window.matchMedia('(display-mode: standalone)').matches) {
            showToast('Welcome back! You\'re already using ReportCardApp as an app.', 'success');
        } else {
            // Show installation prompt after a delay
            setTimeout(() => {
                if (pwaInstaller && pwaInstaller.isInstallable) {
                    showLandingPagePrompt();
                }
            }, 3000);
        }
    });

    function showLandingPagePrompt() {
        // Create a prominent installation banner
        const banner = document.createElement('div');
        banner.id = 'landing-install-banner';
        banner.className = 'position-fixed top-0 start-0 end-0 bg-gradient text-white text-center py-3 shadow-lg';
        banner.style.zIndex = '99999';
        banner.style.backdropFilter = 'blur(10px)';
        
        banner.innerHTML = `
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8 text-start">
                        <strong>ðŸš€ Install ReportCardApp for the best experience!</strong>
                        <span class="d-none d-md-inline ms-3">Get offline access, faster loading, and push notifications.</span>
                    </div>
                    <div class="col-md-4 text-end">
                        <button class="btn btn-light btn-sm rounded-pill me-2" onclick="pwaInstaller.installApp()">
                            <i class="bi bi-download me-1"></i>Install Now
                        </button>
                        <button class="btn btn-outline-light btn-sm rounded-pill" onclick="dismissLandingBanner()">
                            <i class="bi bi-x me-1"></i>Not Now
                        </button>
                    </div>
                </div>
            </div>
        `;

        document.body.appendChild(banner);

        // Auto-hide after 15 seconds
        setTimeout(() => {
            if (banner.parentNode) {
                banner.style.transition = 'opacity 0.5s ease';
                banner.style.opacity = '0';
                setTimeout(() => banner.remove(), 500);
            }
        }, 15000);
    }

    function dismissLandingBanner() {
        const banner = document.getElementById('landing-install-banner');
        if (banner) {
            banner.style.transition = 'opacity 0.3s ease';
            banner.style.opacity = '0';
            setTimeout(() => banner.remove(), 300);
        }
        pwaInstaller.dismissPrompt();
    }

    function scrollToFeatures() {
        const featuresSection = document.getElementById('features');
        if (featuresSection) {
            featuresSection.scrollIntoView({ behavior: 'smooth' });
        }
    }

    // Override the default installation success to show our modal
    const originalInstallApp = window.installApp;
    window.installApp = function() {
        if (pwaInstaller) {
            pwaInstaller.installApp();
        }
    };

    // Listen for successful installation
    window.addEventListener('appinstalled', function() {
        const modal = new bootstrap.Modal(document.getElementById('installation-modal'));
        modal.show();
        
        // Redirect to dashboard after a short delay
        setTimeout(() => {
            window.location.href = '/dashboard/';
        }, 3000);
    });
</script>
{% endblock %}